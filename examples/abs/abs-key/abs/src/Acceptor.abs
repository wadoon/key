module ReplicationSystem.Server.SyncServerAcceptor;

export *;

import * from ReplicationSystem.Environment.DataTypes;
import * from ReplicationSystem.Client.Interfaces;
import * from ReplicationSystem.Server.Interfaces;
import * from ReplicationSystem.Server.ConnectionThread;

import * from ReplicationSystem.Schedulers;

[Plain] 
class SyncServerAcceptorImpl([Final] [Near] SyncServer server) 
implements SyncServerAcceptor {

	Int threads = 0; // for debugging
	
	ConnectionThread getConnection(ClientJob job) {
		ConnectionThread thread = null;
		
		// Shutdown flag	
		Bool shutdown = this.server.isShutdownRequested();
		if (~ shutdown) {
			// allocate resources to connection thread
			thread = new cog ConnectionThreadImpl(job,server,threads);
			threads = threads + 1; // for debugging
		} 
		
		return thread;
	}
	
	Unit finish(ConnectionThread thread) { 	}
	
}