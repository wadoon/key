package evoting;

public class VoteServer {
	private int numberOfCandidates;
	private Voter[] voters;
	private boolean ballotCast[];
	public VoteServer(int numberOfCandidates){
		this.numberOfCandidates= numberOfCandidates;
	}
	
	private int[] getBallots(){
		int[] ballots = new int[voters.length];
		boolean resultComputeReady = false;
		int i=0;
		while(i<voters.length){
			int k = Environment.untrustedInput(numberOfCandidates);
			if(0<=k && k<voters.length && ! ballotCast[k]){
				final Voter v = voters[k];
				Message message = v.onSendBallot();
				ballots[i] = message.getBallot();
				ballotCast[k] = true;
				i++;
			}
		}
		return ballots;
	}
	public Result election(){
		CountingServer countServer = new CountingServer(getBallots(), numberOfCandidates);
		return countServer.publishResult();
	}
	public int getNumberOfCandidates(){
		return numberOfCandidates;
	}
}
