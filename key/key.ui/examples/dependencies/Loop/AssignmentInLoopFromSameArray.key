/*
Assignment to an array from itself in a loop. Loop invariant generated by us (not by predicate abstraction).
Are the pre and post conditions correct?
What should I use instead of old?
It should be closed.
Current State: Not Compiled because of "old".
*/

\predicates{
  
}

\programVariables {
  int[] array;
  int i;
}

\problem {
 /* loop invariant:
     i>=0 & i<=array.length & (\forall int x; (x>=0 & x < i -> array[x] = old(array[x+1])))
     modifies: allFields(array)
     variant: array.length - i
  */
  array!=null & wellFormed(heap) & noW(allFields(array)) & noRaW(allFields(array)) 
   -> {i:=0} \<{ 
                  while(i<array.length-1){
   					array[i]=array[i+1];
   					i++;
   				} 
   			}\>(i=array.length-1 & (\forall int x; (x>=0 & x < array.length -> array[x] = old(array[x+1]))) & noRaW(allFields(array))) 
}