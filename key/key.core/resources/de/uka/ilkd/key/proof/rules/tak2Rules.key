// This file is part of KeY - Integrated Deductive Software Design
//
// Copyright (C) 2001-2011 Universitaet Karlsruhe (TH), Germany
//                         Universitaet Koblenz-Landau, Germany
//                         Chalmers University of Technology, Sweden
// Copyright (C) 2011-2013 Karlsruhe Institute of Technology, Germany
//                         Technical University Darmstadt, Germany
//                         Chalmers University of Technology, Sweden
//
// The KeY system is protected by the GNU General
// Public License. See LICENSE.TXT for details.
//

// This file contains only the RULES for the data type Ord
// of ordinals as needed for proving the results
// 
// from Takeuti's 1965 paper.


\rules{

//--------------------------------------------------------------------------
//  
//  Definition and lemmas for the encoding function jenc
//  
//--------------------------------------------------------------------------

// proofScript exists
\lemma
oaddEncode{
   \schemaVar \variables Ord x,a;
   \add(
    \forall x;\forall a;(oleq(oadd(a,x),encode(a,x)))
   ==>)
};

jencDefQ{
 \schemaVar \variables Ord a,b,c;
   \add( \forall a;\forall b;\forall c;(
           olt(c,onat(9)) -> jenc(a,b,c) = oadd(otimes(onat(9),encode(a,b)),c))
    ==>)
};

// proofScript exists
\lemma
jencDef{
 \schemaVar \term  Ord a,b,c;
    \assumes(olt(c,onat(9)) ==>)
    \find(jenc(a,b,c))  \sameUpdateLevel 
   \replacewith(oadd(otimes(onat(9),encode(a,b)),c))
   \heuristics(simplify_enlarging)
};

// proofScript exists
\lemma
jencSur{
   \schemaVar \variables Ord x,a,b,c;
   \add( \forall x;\exists a;\exists b;\exists c;(
          x = jenc(a,b,c) & olt(c,onat(9)))
    ==>)
};

// proofScript exists
\lemma
jencInj{
   \schemaVar \variables Ord x,y,z,a,b,c;
   \add( \forall x;\forall y;\forall z;\forall  a;\forall b;\forall c;(
           (jenc(x,y,z)  = jenc(a,b,c) & olt(z,onat(9)) &  olt(c,onat(9)))
          -> x=a & y=b & z = c)
    ==>)
};

//--------------------------------------------------------------------------
//  
//  Definition and lemma for decoding jenc
//  
//--------------------------------------------------------------------------

jdecodeDef{
   \schemaVar \variables Ord a;
  \add(\forall a;(jenc(jd1(a),jd2(a),jd3(a)) = a & olt(jd3(a),onat(9))) 
           ==>)
};

jdecode1{
 \schemaVar \variables Ord x,y,z;
  \add(\forall x;\forall y;\forall z;(
       olt(z,onat(9)) -> jd1(jenc(x,y,z)) = x)
      ==>)
};

jdecode2{
 \schemaVar \variables Ord x,y,z;
  \add(\forall x;\forall y;\forall z;(
       olt(z,onat(9)) -> jd2(jenc(x,y,z)) = y)
      ==>)
};

jdecode3{
 \schemaVar \variables Ord x,y,z;
  \add(\forall x;\forall y;\forall z;(
       olt(z,onat(9)) -> jd3(jenc(x,y,z)) = z)
      ==>)
};

}