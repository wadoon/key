\schemaVariables {
  \modalOperator { diamond, box } #allmodal;
  \modalOperator { diamond } #diamond;
  \modalOperator { box } #box;

  \program Variable #v;
  \program SimpleExpression #se;
  \formula post;		

 }
 
 \functions{
   int solidityUintAddition(int, int);
   \unique int UINT_MAX;
 }
 
 
 \predicates {
   inUint(int);
 }

 \rules(intRules:solidity) {
    
    uintMaxDef {
    	\find(UINT_MAX) 
    	\replacewith(115792089237316195423570985008687907853269984665640564039457584007913129639936)
    	\heuristics(simplify)
    
    };
 
 	inUintDef {
 		\schemaVar \term int val;
 		\find(inUint(val))
 		\replacewith(val>=0 & val<=UINT_MAX)
 		\heuristics(simplify) 		
 	};
 
 	translateSolidityUintAddition {
 		\schemaVar \term int left, right;
 		\find(solidityUintAddition(left,right))
 		\replacewith(jmod(left+right,UINT_MAX))
 		\heuristics(simplify)
 	};
 
 }
 
 \rules(programRules:Solidity) {

	assignLocalVariable {
		\find(\modality{#allmodal}{.. #v = #se; ...}\endmodality(post))
		\replacewith({#v:=#se}\modality{#allmodal}{.. ...}\endmodality(post))
		\heuristics(simplify_prog_subset,simplify)
	};
	
	
	assignLocalVariableIntAddition {
	    \schemaVar \program SimpleExpression #left, #right;
	
		\find(\modality{#allmodal}{.. #v = #left + #right; ...}\endmodality(post))
		\replacewith({#v:=solidityUintAddition(#left,#right)}\modality{#allmodal}{.. ...}\endmodality(post))
		\heuristics(simplify_prog_subset,simplify)
		
	};
}
